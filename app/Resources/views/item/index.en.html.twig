{% extends 'base.html.twig' %}

{% block body %}
    <div class="row">
        <div class="col-md-12">
            <p>Hi! How nice of you to check out what we need to get the show going.
                Please help us by pledging to contribute items.</p>
            <form name="missing_items" method="post" action="{{ path('pledge') }}">
                <input type="hidden" name="_csrf_token" value="{{ csrf_token('missing_items') }}">
                <input type="hidden" id="pledged-item" name="pledged-item">
                <table class="table table-bordered table-striped">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Description</th>
                            <th>Required by</th>
                            <th><i class="fa fa-cog" aria-hidden="true"></i></th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in items %}
                        <tr>
                            {% if item.url is empty %}
                            <td>{{ item.name }}</td>
                            {% else %}
                            <td><a href="{{ item.url }}" title="{{ item.url }}" target="_blank">{{ item.name }}</a></td>
                            {% endif %}
                            <td>{{ item.description }}</td>
                            <td>
                                {% if item.due is not empty %}
                                    {{ item.due|date("d.m.Y")}}
                                {% else %}
                                    - no due date -
                                {% endif %}
                            </td>
                            <td><input id="pledge-{{ item.id }}" class="btn btn-xs btn-primary item-pledge" data-id="{{ item.id }}" type="submit" value="Pledge item"></td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </form>
        </div>
    </div>
{% endblock body %}

{% block javascripts %}
    {{ parent() }}
    <script type="text/javascript">
        $( document ).ready(function() {
            $('.item-pledge').click(function () {
                $('#pledged-item').val($(this).attr('data-id'));
            });
        });
    </script>
{% endblock javascripts%}
